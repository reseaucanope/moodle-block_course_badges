define ("block_course_badges/course_badges",["jquery","block_course_badges/jtable"],function(a){return{init_show_more:function(){var b=3;if(1920>a(window).width()&&1441<a(window).width()){b=2}else if(1441>a(window).width()&&1118<=a(window).width()){b=1}else if(1118>a(window).width()&&768<=a(window).width()){b=0}else if(768>a(window).width()&&425<=a(window).width()){b=4}else if(425>a(window).width()&&320<a(window).width()){b=2}else if(320>=a(window).width()){b=1}b=2*b+1;a(".badgescontent").each(function(c,d){if(a(d).children(".bcb_badge").length<=b){a(d).children(".showmore").hide()}a(d).children(".bcb_badge:gt("+(b-1)+")").hide()});a(".showmore").click(function(){a(this).parent().children(".bcb_badge").show();a(this).remove()})},init_block_header:function(){a("div[class^=\"block_course_badges\"] h3").click(function(){a(this).next().toggle()})},init_jtable:function(b,c,d,e){var f=M.cfg.wwwroot;a("head").append("<link rel=\"stylesheet\" type=\"text/css\" href=\""+f+"/lib/jquery/ui-1.12.1/jquery-ui.min.css\">");var b=a("input[name=\""+b+"\"]").val();b=JSON.parse(b);if(b.imgurl){b.imgurl.display=function(a){if(a.record.badgeurl){return"<a href=\""+a.record.badgeurl+"\"><img class=\"cb_overviewbadge\" src=\""+a.record.imgurl+"\"/></a>"}return"<img class=\"cb_overviewbadge\" src=\""+a.record.imgurl+"\"/>"}}if(b.modname){b.modname.display=function(a){for(var b=a.record,c="",d=0;d<b.modnames.length;d++){if(b.modnames[d].coursebadgeurl){c+="<a href=\""+b.modnames[d].coursebadgeurl+"\">"+b.modnames[d].name+"</a><br/>"}else{c+=b.modnames[d].name+"<br/>"}}return c}}if(b.percent){b.percent.display=function(a){var b=a.record;if(b.urlearnedbadge&&b.urlselectedbadge){return"<p><a href=\""+b.urlearnedbadge+"\">"+b.badgeearnedcount+"</a>/<a href="+b.urlselectedbadge+">"+b.badgetotal+"</a> ("+b.badgepercent+"%)</p>"}return"<p>"+b.badgeearnedcount+"/"+b.badgetotal+" ("+b.badgepercent+"%)</p>"}}if(b.groupnames){b.groupnames.display=function(a){for(var b=a.record,c="",d=0;d<b.groupnames.length;d++){c+=b.groupnames[d].name+"<br/>"}return c}}if(b.earnedbadges){b.earnedbadges.display=function(a){for(var b=a.record,c="",d=0;d<b.allearnedbadgeids.length;d++){if(b.allearnedbadgeids[d].badge_url){c+="<a href=\""+b.allearnedbadgeids[d].badge_url+"\"><img class=\"cb_overviewbadge_mini\" src=\""+b.allearnedbadgeids[d].img_url+"\"/></a>"}else{c+="<img class=\"cb_overviewbadge_mini\" src=\""+b.allearnedbadgeids[d].img_url+"\"/>"}}return c}}if(b.selectedbadges){b.selectedbadges.display=function(a){for(var b=a.record,c="",d=0;d<b.selectedbadges.length;d++){if(b.selectedbadges[d].badge_url){c+="<a href=\""+b.selectedbadges[d].badge_url+"\"><img class=\"cb_overviewbadge_mini\" src=\""+b.selectedbadges[d].img_url+"\"/></a>"}else{c+="<img class=\"cb_overviewbadge_mini\" src=\""+b.selectedbadges[d].img_url+"\"/>"}}return c}}var g=a("#"+c).jtable({paging:!0,pageSize:10,pageSizes:[10,25,50,100],selecting:!1,multiselect:!1,sorting:!0,defaultSorting:e,jqueryuiTheme:!0,defaultDateFormat:"dd-mm-yy",gotoPageArea:"none",actions:{listAction:function listAction(b,c){return a.Deferred(function(e){b=a(".mform").serialize();a.ajax({url:d+"&si="+c.jtStartIndex+"&ps="+c.jtPageSize+"&so="+c.jtSorting,type:"POST",dataType:"json",data:b,success:function success(a){e.resolve(a)},error:function error(){e.reject()}})})}},fields:b});g.jtable("load")},init_select_overview:function(){a(".mform select").change(function(){a("#results").jtable("load")})},init_name_input:function(b){var c;a(".mform input[name=\""+b+"\"]").on("keyup",function(){clearTimeout(c);c=setTimeout(function(){a("#results").jtable("load")},500)})},init_custom_select:function(b){b="."+b;var c=b+" .options",d=b+" .option-selected";a(b+" .option-selected-arrow, "+d).click(function(){a(b+" .option-selected-arrow").toggleClass("expand");a(d+", "+b+" .option-selected-arrow").toggleClass("focus");a(c).toggle()});a(b+" .option label").click(function(){var b=a(this).closest(".option"),e=b.find("label").html();a(d).html(e);a(c+" .option.selected").removeClass("selected");b.addClass("selected");b.closest(".options").find("input").removeAttr("checked");b.find("input").attr("checked","checked");a(c).hide();a(".mform").submit()});a("body").click(function(f){if(!a(c).is(":visible")){return}var e={left:f.pageX,top:f.pageY},g=a(c).position();g.left+=a(c).offset().left;var h=a(d).position();h.top+=a(d).offset().top;var i=a(c).width(),j=a(c).height(),k={top:h.top,left:g.left},l={top:k.top+j,left:k.left+i};if(e.top>=k.top&&e.top<=l.top&&e.left>=k.left&&e.left<=l.left){return}a(c).hide();a(d+", "+b+" .option-selected-arrow").removeClass("focus")})}}});
//# sourceMappingURL=course_badges.min.js.map
