{"version":3,"sources":["../src/course_badges.js"],"names":["define","$","init_show_more","nb_badge_show","window","width","each","i","v","children","length","hide","click","parent","show","remove","init_block_header","next","toggle","init_jtable","columns","table","ajaxbaseurl","defaultsorting","wwwroot","M","cfg","append","val","JSON","parse","imgurl","display","data","record","badgeurl","modname","r","res","modnames","coursebadgeurl","name","percent","urlearnedbadge","urlselectedbadge","badgeearnedcount","badgetotal","badgepercent","groupnames","earnedbadges","allearnedbadgeids","badge_url","img_url","selectedbadges","selectionTable","jtable","paging","pageSize","pageSizes","selecting","multiselect","sorting","defaultSorting","jqueryuiTheme","defaultDateFormat","gotoPageArea","actions","listAction","postData","jtParams","Deferred","$dfd","serialize","ajax","url","jtStartIndex","jtPageSize","jtSorting","type","dataType","success","resolve","error","reject","fields","init_select_overview","change","init_name_input","timer","on","clearTimeout","setTimeout","init_custom_select","options","optionselected","toggleClass","opt","closest","content","find","html","removeClass","addClass","removeAttr","attr","submit","e","is","mouse","left","pageX","top","pageY","pos_options","position","offset","pos_selected","options_width","options_height","height","min","max"],"mappings":"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","sourcesContent":["/* jshint ignore:start */\r\ndefine(['jquery', 'block_course_badges/jtable'], function($) {\r\n   function init_show_more()\r\n   {\r\n       var nb_badge_show = 3;\r\n       if ($( window ).width() < 1920 && $( window ).width() > 1441){\r\n           nb_badge_show = 2;\r\n       } else if ($( window ).width() < 1441 && $( window ).width() >= 1118){\r\n           nb_badge_show = 1;\r\n       } else if ($( window ).width() < 1118 && $( window ).width() >= 768){\r\n           nb_badge_show = 0;\r\n       } else if ($( window ).width() < 768 && $( window ).width() >= 425){\r\n           nb_badge_show = 4;\r\n       } else if ($( window ).width() < 425 && $( window ).width() > 320){\r\n           nb_badge_show = 2;\r\n       } else if ($( window ).width() <= 320) {\r\n           nb_badge_show = 1;\r\n       }\r\n       nb_badge_show = nb_badge_show *2 + 1; // pour avoir 2 lignes affichés selon la résolution\r\n\r\n       $('.badgescontent').each(function(i, v){\r\n           if($(v).children(('.bcb_badge')).length <= nb_badge_show){\r\n               $(v).children('.showmore').hide();\r\n           };\r\n           $(v).children(('.bcb_badge:gt('+(nb_badge_show-1)+')')).hide();\r\n       });\r\n\r\n       $('.showmore').click(function(){\r\n           $(this).parent().children(('.bcb_badge')).show();\r\n           $(this).remove();\r\n       })\r\n   }\r\n\r\n   function initJtable(columns, table, ajaxbaseurl, defaultsorting, formid)\r\n   {\r\n       var wwwroot = M.cfg.wwwroot;\r\n       $('head').append('<link rel=\"stylesheet\" type=\"text/css\" href=\"'+wwwroot+'/lib/jquery/ui-1.12.1/jquery-ui.min.css\">');\r\n\r\n       var columns = $('input[name=\"'+columns+'\"]').val();\r\n       columns = JSON.parse(columns);\r\n       if(columns.imgurl){\r\n           columns.imgurl.display = function(data){\r\n\t\t\t   if (data.record.badgeurl) {\r\n\t\t\t\t   return '<a href=\"'+data.record.badgeurl+'\"><img class=\"cb_overviewbadge\" src=\"'+data.record.imgurl+'\"/></a>';\r\n\t\t\t   }\r\n\t\t\t   return '<img class=\"cb_overviewbadge\" src=\"'+data.record.imgurl+'\"/>';\r\n           }\r\n       }\r\n\r\n       if(columns.modname){\r\n           columns.modname.display = function(data){\r\n               var r = data.record;\r\n               var res = '';\r\n               for(var i=0; i<r.modnames.length; i++){\r\n\t\t\t\t   if (r.modnames[i].coursebadgeurl) {\r\n\t\t\t\t\t   res += '<a href=\"'+ r.modnames[i].coursebadgeurl +'\">'+r.modnames[i].name+'</a><br/>';\r\n\t\t\t\t   } else {\r\n\t\t\t\t\t   res += r.modnames[i].name+'<br/>';\r\n\t\t\t\t   }\r\n               }\r\n               return res;\r\n           }\r\n       }\r\n\r\n       if(columns.percent){\r\n           columns.percent.display = function(data){\r\n               var r = data.record;\r\n\r\n              if (r.urlearnedbadge && r.urlselectedbadge) {\r\n            \t  return '<p><a href=\"'+ r.urlearnedbadge +'\">'+r.badgeearnedcount+'</a>/<a href='+ r.urlselectedbadge +'>'+r.badgetotal+'</a> ('+r.badgepercent+'%)</p>';\r\n              }\r\n              return '<p>'+r.badgeearnedcount+'/'+r.badgetotal+' ('+r.badgepercent+'%)</p>';\r\n           }\r\n       }\r\n\r\n       if(columns.groupnames){\r\n           columns.groupnames.display = function(data){\r\n               var r = data.record;\r\n               var res = '';\r\n               for(var i=0; i<r.groupnames.length; i++){\r\n                   res += r.groupnames[i].name+'<br/>';\r\n               }\r\n               return res;\r\n           }\r\n       }\r\n\r\n       if(columns.earnedbadges){\r\n           columns.earnedbadges.display = function(data){\r\n               var r = data.record;\r\n               var res = '';\r\n               for(var i=0; i<r.allearnedbadgeids.length; i++){\r\n            \t   if (r.allearnedbadgeids[i].badge_url) {\r\n            \t\t   res += '<a href=\"'+r.allearnedbadgeids[i].badge_url+'\"><img class=\"cb_overviewbadge_mini\" src=\"'+r.allearnedbadgeids[i].img_url+'\"/></a>';\r\n            \t   } else {\r\n            \t\t   res += '<img class=\"cb_overviewbadge_mini\" src=\"'+r.allearnedbadgeids[i].img_url+'\"/>';\r\n            \t   }\r\n\r\n               }\r\n               return res;\r\n           }\r\n       }\r\n\r\n       if(columns.selectedbadges){\r\n           columns.selectedbadges.display = function(data){\r\n               var r = data.record;\r\n               var res = '';\r\n               for(var i=0; i<r.selectedbadges.length; i++){\r\n            \t   if (r.selectedbadges[i].badge_url) {\r\n            \t\t   res += '<a href=\"'+r.selectedbadges[i].badge_url+'\"><img class=\"cb_overviewbadge_mini\" src=\"'+r.selectedbadges[i].img_url+'\"/></a>';\r\n            \t   } else {\r\n            \t\t   res += '<img class=\"cb_overviewbadge_mini\" src=\"'+r.selectedbadges[i].img_url+'\"/>';\r\n            \t   }\r\n\r\n               }\r\n               return res;\r\n           }\r\n       }\r\n\r\n       var selectionTable = $(\"#\"+table).jtable({\r\n           paging: true,\r\n           pageSize: 10,\r\n           pageSizes: [10, 25, 50, 100],\r\n           selecting: false,\r\n           multiselect: false,\r\n           sorting: true,\r\n           defaultSorting: defaultsorting,\r\n           jqueryuiTheme: true,\r\n           defaultDateFormat: \"dd-mm-yy\",\r\n           gotoPageArea: \"none\",\r\n           actions: {\r\n               listAction: function (postData, jtParams) {\r\n                   return $.Deferred(function ($dfd) {\r\n\r\n                       postData = $('.mform').serialize();\r\n                       $.ajax({\r\n                           url: ajaxbaseurl+'&si=' + jtParams.jtStartIndex + '&ps=' + jtParams.jtPageSize + '&so=' + jtParams.jtSorting,\r\n                           type: \"POST\",\r\n                           dataType: \"json\",\r\n                           data: postData,\r\n                           success: function (data) {\r\n                               $dfd.resolve(data);\r\n                           },\r\n                           error: function () {\r\n                               $dfd.reject();\r\n                           }\r\n                       });\r\n                   });\r\n               },\r\n           },\r\n           fields: columns\r\n       });\r\n\r\n       selectionTable.jtable(\"load\");\r\n   }\r\n\r\n   function init_select_overview()\r\n   {\r\n       $('.mform select').change(function(){\r\n           $(\"#results\").jtable(\"load\");\r\n       })\r\n   }\r\n\r\n   function init_name_input(name)\r\n   {\r\n       var timer;\r\n       $('.mform input[name=\"'+name+'\"]').on('keyup', function(){\r\n           clearTimeout(timer);\r\n           timer = setTimeout(function(){\r\n               $(\"#results\").jtable(\"load\");\r\n           }, 500);\r\n\r\n       })\r\n   }\r\n\r\n   function init_block_header()\r\n   {\r\n       $('div[class^=\"block_course_badges\"] h3').click(function(){\r\n           $(this).next().toggle();\r\n       });\r\n   }\r\n\r\n   function init_custom_select(name, formid)\r\n   {\r\n       name = '.'+name;\r\n\r\n       var options = name+' .options';\r\n       var optionselected = name+' .option-selected';\r\n\r\n       $(name+' .option-selected-arrow, '+optionselected).click(function(){\r\n           $(name+' .option-selected-arrow').toggleClass('expand');\r\n           $(optionselected+', '+name+' .option-selected-arrow').toggleClass('focus');\r\n           $(options).toggle();\r\n       });\r\n\r\n       $(name+' .option label').click(function(){\r\n\r\n           var opt =  $(this).closest('.option');\r\n           var content = opt.find('label').html();\r\n           $(optionselected).html(content);\r\n\r\n           $(options+' .option.selected').removeClass('selected');\r\n\r\n           opt.addClass('selected');\r\n           opt.closest('.options').find('input').removeAttr('checked');\r\n           opt.find('input').attr('checked','checked');\r\n           $(options).hide();\r\n\r\n           $('.mform').submit();\r\n\r\n       });\r\n\r\n       /*\r\n        * Here we simulate a kind of blur event, but with multiple element\r\n        * we compute the bounding box around the elements\r\n        */\r\n       $('body').click(function(e){\r\n           if(!$(options).is(':visible')){\r\n               return;\r\n           }\r\n\r\n           var mouse = {\r\n               left: e.pageX,\r\n               top: e.pageY\r\n           };\r\n\r\n           var pos_options = $(options).position();\r\n           pos_options.left += $(options).offset().left;\r\n\r\n\r\n           var pos_selected = $(optionselected).position();\r\n           pos_selected.top += $(optionselected).offset().top;\r\n\r\n           var options_width = $(options).width();\r\n           var options_height = $(options).height();\r\n\r\n           var min = {\r\n               top: pos_selected.top,\r\n               left: pos_options.left\r\n           };\r\n\r\n           var max = {\r\n               top: min.top + options_height,\r\n               left: min.left + options_width\r\n           };\r\n\r\n\r\n           if(mouse.top >= min.top && mouse.top <= max.top && mouse.left >= min.left && mouse.left <= max.left){\r\n               return;\r\n           }\r\n\r\n           $(options).hide();\r\n           $(optionselected+', '+name+' .option-selected-arrow').removeClass('focus');\r\n       })\r\n   }\r\n\r\n   return {\r\n       init_show_more: init_show_more,\r\n       init_block_header: init_block_header,\r\n       init_jtable: initJtable,\r\n       init_select_overview: init_select_overview,\r\n       init_name_input: init_name_input,\r\n       init_custom_select: init_custom_select\r\n   }\r\n});\r\n"],"file":"course_badges.min.js"}